#!/bin/bash

CFG_FILE=/etc/te-agent.cfg

ACCOUNT_TOKEN="account-token=<%= @account_token %>"
LOG_PATH="log-path=<%= @log_path %>"
LOG_FILE_SIZE="log-file-size=<%= @log_file_size %>"
PROXY_USER="proxy-user=<%= @proxy_user %>"
PROXY_PASS="proxy-pass=<%= @proxy_pass %>"
PROXY_BYPASS_LIST="proxy-bypass-list=<%= @proxy_bypass_list %>"

# sed account-token
CUR_ACCOUNT_TOKEN=$(cat ${CFG_FILE}|grep 'account-token')
sed -i ${CFG_FILE} -e "s/$CUR_ACCOUNT_TOKEN/$ACCOUNT_TOKEN/g" >/dev/null 2>&1

# sed log-path
CUR_LOG_PATH=$(cat ${CFG_FILE}|grep 'log-path')
sed -i ${CFG_FILE} -e "s,$CUR_LOG_PATH,$LOG_PATH,g" >/dev/null 2>&1

# sed log-file-size
CUR_LOG_FILE_SIZE=$(cat ${CFG_FILE}|grep 'log-file-size')
sed -i ${CFG_FILE} -e "s,$CUR_LOG_FILE_SIZE,$LOG_FILE_SIZE,g" >/dev/null 2>&1

# sed proxy-user
CUR_PROXY_USER=$(cat ${CFG_FILE}|grep 'proxy-user')
sed -i ${CFG_FILE} -e "s/$CUR_PROXY_USER/$PROXY_USER/g"

# sed proxy-pass
CUR_PROXY_PASS=$(cat ${CFG_FILE}|grep 'proxy-pass')
sed -i ${CFG_FILE} -e "s/$CUR_PROXY_PASS/$PROXY_PASS/g"

# sed proxy-bypass-list
CUR_PROXY_BYPASS_LIST=$(cat ${CFG_FILE}|grep 'proxy-bypass-list')
sed -i ${CFG_FILE} -e "s/$CUR_PROXY_BYPASS_LIST/$PROXY_BYPASS_LIST/g"
